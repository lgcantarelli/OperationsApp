/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package GUI;
import java.awt.Color;
import java.io.File;
import java.text.DateFormat;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.List;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.ComboBoxModel;
import operationsapp.*;
import javax.swing.JFileChooser;
import javax.swing.JOptionPane;
import static javax.swing.JOptionPane.OK_CANCEL_OPTION;
import javax.swing.JTextField;

/**
 *
 * @author matheus
 */
public class GUIHome extends javax.swing.JFrame {

    /**
     * Creates new form GUIHome
     */
    public GUIHome() {
        initComponents();
        user = new User();
        id=0;
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        buttonGroupMoreInf = new javax.swing.ButtonGroup();
        expFilExp = new javax.swing.JFileChooser();
        buttonGroupAdd = new javax.swing.ButtonGroup();
        panelInf = new javax.swing.JTabbedPane();
        panelExtract = new javax.swing.JPanel();
        labelChaRev = new javax.swing.JLabel();
        listExtract = new javax.swing.JScrollPane();
        jList2 = new javax.swing.JList<>();
        separatorExtract = new javax.swing.JSeparator();
        labelBalance = new javax.swing.JLabel();
        valueBalance = new javax.swing.JLabel();
        panelReport = new javax.swing.JPanel();
        panelAdd = new javax.swing.JPanel();
        labelDate = new javax.swing.JLabel();
        labelValue = new javax.swing.JLabel();
        addValue = new javax.swing.JTextField();
        selectCategory = new javax.swing.JComboBox<>();
        buttonAdd = new javax.swing.JButton();
        radioButtonCharge = new javax.swing.JRadioButton();
        radioButtonRevenue = new javax.swing.JRadioButton();
        labelCategory = new javax.swing.JLabel();
        addDate = new javax.swing.JTextField();
        buttonExp = new javax.swing.JButton();

        expFilExp.setAcceptAllFileFilterUsed(false);
        expFilExp.setDialogType(javax.swing.JFileChooser.SAVE_DIALOG);

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        setBackground(new java.awt.Color(255, 255, 255));
        setResizable(false);

        labelChaRev.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        labelChaRev.setText("Extrato");

        jList2.setModel(new javax.swing.AbstractListModel<String>() {
            String[] strings = { "Item 1", "Item 2", "Item 3", "Item 4", "Item 5" };
            public int getSize() { return strings.length; }
            public String getElementAt(int i) { return strings[i]; }
        });
        jList2.setSelectionMode(javax.swing.ListSelectionModel.SINGLE_SELECTION);
        listExtract.setViewportView(jList2);

        labelBalance.setFont(new java.awt.Font("Tahoma", 0, 24)); // NOI18N
        labelBalance.setText("Saldo");

        valueBalance.setFont(new java.awt.Font("Tahoma", 0, 24)); // NOI18N

        javax.swing.GroupLayout panelExtractLayout = new javax.swing.GroupLayout(panelExtract);
        panelExtract.setLayout(panelExtractLayout);
        panelExtractLayout.setHorizontalGroup(
            panelExtractLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panelExtractLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(panelExtractLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(labelChaRev, javax.swing.GroupLayout.DEFAULT_SIZE, 685, Short.MAX_VALUE)
                    .addComponent(listExtract)
                    .addComponent(separatorExtract)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, panelExtractLayout.createSequentialGroup()
                        .addGap(0, 0, Short.MAX_VALUE)
                        .addGroup(panelExtractLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, panelExtractLayout.createSequentialGroup()
                                .addComponent(labelBalance)
                                .addGap(167, 167, 167))
                            .addComponent(valueBalance, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 224, javax.swing.GroupLayout.PREFERRED_SIZE))))
                .addContainerGap())
        );
        panelExtractLayout.setVerticalGroup(
            panelExtractLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panelExtractLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(labelChaRev, javax.swing.GroupLayout.PREFERRED_SIZE, 26, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 59, Short.MAX_VALUE)
                .addComponent(listExtract, javax.swing.GroupLayout.PREFERRED_SIZE, 442, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(separatorExtract, javax.swing.GroupLayout.PREFERRED_SIZE, 10, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(1, 1, 1)
                .addComponent(labelBalance, javax.swing.GroupLayout.PREFERRED_SIZE, 45, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(valueBalance)
                .addGap(16, 16, 16))
        );

        valueBalance.setText("R$ " + balance);
        if(balance<0){
            valueBalance.setForeground(Color.red);
        }else if(balance>0){
            valueBalance.setForeground(Color.green);
        }else{
            valueBalance.setForeground(Color.BLACK);
        }

        panelInf.addTab("Extrato", panelExtract);

        javax.swing.GroupLayout panelReportLayout = new javax.swing.GroupLayout(panelReport);
        panelReport.setLayout(panelReportLayout);
        panelReportLayout.setHorizontalGroup(
            panelReportLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 705, Short.MAX_VALUE)
        );
        panelReportLayout.setVerticalGroup(
            panelReportLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 627, Short.MAX_VALUE)
        );

        panelInf.addTab("Graficos", panelReport);

        labelDate.setText("Data");

        labelValue.setText("Valor");

        buttonAdd.setText("Adicionar");
        buttonAdd.setBorder(null);
        buttonAdd.setCursor(new java.awt.Cursor(java.awt.Cursor.DEFAULT_CURSOR));

        buttonGroupAdd.add(radioButtonCharge);
        radioButtonCharge.setText("Despesa");

        buttonGroupAdd.add(radioButtonRevenue);
        radioButtonRevenue.setText("Receita");

        labelCategory.setText("Categoria");

        javax.swing.GroupLayout panelAddLayout = new javax.swing.GroupLayout(panelAdd);
        panelAdd.setLayout(panelAddLayout);
        panelAddLayout.setHorizontalGroup(
            panelAddLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panelAddLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(panelAddLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(buttonAdd, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(addValue)
                    .addComponent(selectCategory, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addGroup(panelAddLayout.createSequentialGroup()
                        .addComponent(radioButtonCharge)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 48, Short.MAX_VALUE)
                        .addComponent(radioButtonRevenue))
                    .addGroup(panelAddLayout.createSequentialGroup()
                        .addGroup(panelAddLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(labelDate)
                            .addComponent(labelValue, javax.swing.GroupLayout.PREFERRED_SIZE, 33, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(labelCategory))
                        .addGap(0, 0, Short.MAX_VALUE))
                    .addComponent(addDate))
                .addContainerGap())
        );
        panelAddLayout.setVerticalGroup(
            panelAddLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panelAddLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(panelAddLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(radioButtonCharge)
                    .addComponent(radioButtonRevenue))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(labelDate)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(addDate, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(labelValue)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(addValue, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(labelCategory)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(selectCategory, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 19, Short.MAX_VALUE)
                .addComponent(buttonAdd, javax.swing.GroupLayout.PREFERRED_SIZE, 38, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );

        if(radioButtonCharge.isSelected() == false && radioButtonRevenue.isSelected() == false ){
            selectCategory.setEnabled(false);
        }
        buttonAdd.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                if(addValue.getText().trim().equals("")){
                    JOptionPane.showMessageDialog(null, "Campo Valor vazio");
                }else if(addDate.getText().trim().equals("")){
                    JOptionPane.showMessageDialog(null, "Campo Data vazio");
                }else{//confirmAddRev.setSize(300,150);
                    //confirmAddRev.setVisible(true);
                    if(radioButtonCharge.isSelected() == true){
                        int confirmBox = JOptionPane.showConfirmDialog(null, "salvar DESPESA",null,OK_CANCEL_OPTION);
                        if(confirmBox == JOptionPane.OK_OPTION){
                            buttonConfirmAddChar();
                        }
                    }else if(radioButtonRevenue.isSelected() == true){
                        int confirmBox = JOptionPane.showConfirmDialog(null, "salvar Receita",null,OK_CANCEL_OPTION);
                        if(confirmBox == JOptionPane.OK_OPTION){
                            buttonConfirmAddRev();
                        }
                    }else{
                        JOptionPane.showMessageDialog(null, "Seleciona o tipo de transação");
                    }
                }
            }
        });
        radioButtonCharge.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                selectCategory.removeAllItems();
                selectCategory.addItem("Supermecado");
                selectCategory.addItem("Aluguel");
                selectCategory.addItem("Luz");
                selectCategory.addItem("Água");
                selectCategory.addItem("Telefone");
                selectCategory.addItem("Internet");
                selectCategory.addItem("Celular");
                selectCategory.setEnabled(true);
            }
        });
        radioButtonRevenue.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                selectCategory.removeAllItems();
                selectCategory.addItem("Bolsa");
                selectCategory.addItem("Freelance");
                selectCategory.addItem("Salário");
                selectCategory.addItem("Outros");
                selectCategory.setEnabled(true);
            }
        });

        buttonExp.setText("Exportar");
        buttonExp.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                buttonExpActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createSequentialGroup()
                        .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(buttonExp)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED))
                    .addGroup(layout.createSequentialGroup()
                        .addContainerGap()
                        .addComponent(panelAdd, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
                .addComponent(panelInf)
                .addContainerGap())
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(panelInf)
            .addGroup(layout.createSequentialGroup()
                .addGap(27, 27, 27)
                .addComponent(panelAdd, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(buttonExp)
                .addGap(29, 29, 29))
        );

        setSize(new java.awt.Dimension(948, 694));
        setLocationRelativeTo(null);
    }// </editor-fold>//GEN-END:initComponents
   
    private void addValueActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_addValueActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_addValueActionPerformed
    private void buttonConfirmAddRev(){
         try {
            // TODO add your handling code here:
            DateFormat format = DateFormat.getDateInstance();
            id += 1;
            double value = Double.parseDouble(addValue.getText());
            String textDate = addDate.getText();
            String descrip = null;
            Date date;
            date = format.parse(textDate);
            RevenueCategory category = null;
            Revenue revenue = new Revenue(id,value,descrip,date,category);
            user.add_revenue(revenue);
            balanceUpdate();
            addValue.setText(null);
            addDate.setText(null);
            selectCategory.removeAllItems();
            selectCategory.setEnabled(false);
            buttonGroupAdd.clearSelection();
        } catch (ParseException ex) {
            Logger.getLogger(GUIHome.class.getName()).log(Level.SEVERE, null, ex);
        }
    }
                
    private void buttonConfirmAddChar(){
         try {
            // TODO add your handling code here:
            DateFormat format = DateFormat.getDateInstance();
            id += 1;
            double value = Double.parseDouble(addValue.getText());
            String textDate = addDate.getText();
            String descrip = null;
            Date date;
            date = format.parse(textDate);
            ChargeCategory category = null;
            Charge charge = new Charge(id,value,descrip,date,category);
            user.add_charge(charge);
            balanceUpdate();
            addValue.setText(null);
            addDate.setText(null);
            selectCategory.removeAllItems();
            selectCategory.setEnabled(false);
            buttonGroupAdd.clearSelection();
            
        } catch (ParseException ex) {
            Logger.getLogger(GUIHome.class.getName()).log(Level.SEVERE, null, ex);
        }
    }
    private void buttonExpActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_buttonExpActionPerformed
        // TODO add your handling code here:
        int returnVal = expFilExp.showSaveDialog(this);
        if(returnVal == JFileChooser.APPROVE_OPTION){
        File file = expFilExp.getSelectedFile();
        } else{
            System.out.println("File access cancelled by user.");
        }
    }//GEN-LAST:event_buttonExpActionPerformed

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(GUIHome.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(GUIHome.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(GUIHome.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(GUIHome.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new GUIHome().setVisible(true);
            }
        });
    }


public void balanceUpdate(){
    balance = user.get_balance();
    valueBalance.setText("R$ " + balance);
    if(balance<0){
        valueBalance.setForeground(Color.red);
    }else if(balance>0){
        valueBalance.setForeground(Color.green);
    }else{
        valueBalance.setForeground(Color.BLACK);
    }
}

public void comboBoxRev(){
    
}


    private User user;
    private double balance;
    int id;

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JTextField addDate;
    private javax.swing.JTextField addValue;
    private javax.swing.JButton buttonAdd;
    private javax.swing.JButton buttonExp;
    private javax.swing.ButtonGroup buttonGroupAdd;
    private javax.swing.ButtonGroup buttonGroupMoreInf;
    private javax.swing.JFileChooser expFilExp;
    private javax.swing.JList<String> jList2;
    private javax.swing.JLabel labelBalance;
    private javax.swing.JLabel labelCategory;
    private javax.swing.JLabel labelChaRev;
    private javax.swing.JLabel labelDate;
    private javax.swing.JLabel labelValue;
    private javax.swing.JScrollPane listExtract;
    private javax.swing.JPanel panelAdd;
    private javax.swing.JPanel panelExtract;
    private javax.swing.JTabbedPane panelInf;
    private javax.swing.JPanel panelReport;
    private javax.swing.JRadioButton radioButtonCharge;
    private javax.swing.JRadioButton radioButtonRevenue;
    private javax.swing.JComboBox<String> selectCategory;
    private javax.swing.JSeparator separatorExtract;
    private javax.swing.JLabel valueBalance;
    // End of variables declaration//GEN-END:variables
}
